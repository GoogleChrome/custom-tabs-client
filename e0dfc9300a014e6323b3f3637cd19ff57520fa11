{
  "comments": [
    {
      "key": {
        "uuid": "5225acf2_98598b66",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 64,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "I\u0027m not sure a semaphore is the right way to go here.\n\nCould you instead use a CountDownLatch? You\u0027d initialize it with new CountDownLatch(1) in the constructor, and then an arbitrary number of threads can wait for the task to finish. You could rename this class slightly to better represent the underlying structure, maybe something like UriAccessLatch?",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "32a82655_cb1d97a6",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 64,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5225acf2_98598b66",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b32fdf5b_d2ddf584",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 66,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "super(1) if you use CountDownLatch?",
      "range": {
        "startLine": 66,
        "startChar": 18,
        "endLine": 66,
        "endChar": 25
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db5e118f_43bafd91",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 66,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b32fdf5b_d2ddf584",
      "range": {
        "startLine": 66,
        "startChar": 18,
        "endLine": 66,
        "endChar": 25
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ec2057e_c86fb502",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 70,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Remove this method? It just calls super.",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a1c42c9_426c648b",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 70,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ec2057e_c86fb502",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d97f215f_be7819b9",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 75,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Maybe just invoke countDown() here?",
      "range": {
        "startLine": 75,
        "startChar": 20,
        "endLine": 75,
        "endChar": 43
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "68ec9a15_cd420099",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 75,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d97f215f_be7819b9",
      "range": {
        "startLine": 75,
        "startChar": 20,
        "endLine": 75,
        "endChar": 43
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "32ce0c0a_caa4c644",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 78,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "I don\u0027t think you need this if you use a CountDownLatch.",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cff14bf1_1cad747d",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 78,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "32ce0c0a_caa4c644",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8d021fff_a27bc5f1",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 109,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Delete this line?",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de88dc72_c083b67a",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 109,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8d021fff_a27bc5f1",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b4b4e1f_42afc37e",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 116,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Optional: saveFileBlocking",
      "range": {
        "startLine": 116,
        "startChar": 24,
        "endLine": 116,
        "endChar": 32
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "86313e23_f4347f91",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 116,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8b4b4e1f_42afc37e",
      "range": {
        "startLine": 116,
        "startChar": 24,
        "endLine": 116,
        "endChar": 32
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "555c85cb_1e6fa2f5",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 128,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Optional: saveFileIfNeededBlocking",
      "range": {
        "startLine": 128,
        "startChar": 21,
        "endLine": 128,
        "endChar": 37
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "331af294_f9e80788",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 128,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "555c85cb_1e6fa2f5",
      "range": {
        "startLine": 128,
        "startChar": 21,
        "endLine": 128,
        "endChar": 37
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0dea4764_2ed5c659",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 132,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "So, this is inherently unsafe if you call generateUri(...) with the same name and version, but not the same bitmap, since the Bitmap is not part of the URI or filename. Is that intentional?",
      "range": {
        "startLine": 132,
        "startChar": 12,
        "endLine": 132,
        "endChar": 45
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7e4614bc_df25ff68",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 132,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "With the check on add function, if it give different bitmaps but same name and version number, only the first bitmap will be saved.",
      "parentUuid": "0dea4764_2ed5c659",
      "range": {
        "startLine": 132,
        "startChar": 12,
        "endLine": 132,
        "endChar": 45
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bde2a596_a853a2a1",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 144,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "This doesn\u0027t seem to be a strict guarantee with your API right now.",
      "range": {
        "startLine": 143,
        "startChar": 47,
        "endLine": 144,
        "endChar": 30
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c366dbef_c65401b5",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 144,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Yes, with the new check on add, it should be fixed.",
      "parentUuid": "bde2a596_a853a2a1",
      "range": {
        "startLine": 143,
        "startChar": 47,
        "endLine": 144,
        "endChar": 30
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4af58f16_5803f547",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 152,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Do you want to check the return value here to see if this process had already started? Or is it intentional that an arbitrary of the files get saved in case name and version are the same?",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb78af91_eb3a4bd2",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 152,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Yes, you are right! I should check whether uri is already existed. If so, skip saving the file again. Thanks for pointing out!",
      "parentUuid": "4af58f16_5803f547",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bd8f5d5b_20bb973a",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 208,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "I don\u0027t think you need this in the world of using CountDownLatch.",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f13fddbe_a19deeed",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 208,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd8f5d5b_20bb973a",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cd708082_de684e5f",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 211,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Here you\u0027d invoke latch.await();.",
      "range": {
        "startLine": 211,
        "startChar": 12,
        "endLine": 211,
        "endChar": 29
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ddd22409_2ef40cb1",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 211,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cd708082_de684e5f",
      "range": {
        "startLine": 211,
        "startChar": 12,
        "endLine": 211,
        "endChar": 29
      },
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dc3af1bb_5c1b4d3d",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 215,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Nit: Maybe add a comment here that this will happen N times, depending on how many threads are waiting, but that it\u0027s OK to do this operation many times?",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcb6dfc5_380c03f8",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 215,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dc3af1bb_5c1b4d3d",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "60c677cc_55d85d9f",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 216,
      "author": {
        "id": 1002237
      },
      "writtenOn": "2018-01-19T02:33:19Z",
      "side": 1,
      "message": "Conceptually, if you kick this process off again from the generateUri(...) with the same input data, except bitmap, at the exact time as the await() call above has finished for the previous call, but before we get to remove it from the map, and then in addition someone at the exact same time queries or tries to open the file, we might try to wait for the current latch instead of creating a new one, even though it will be removed while the new background task is running. I\u0027m not sure if that\u0027s something you\u0027d want to worry about? It seems far-fetched.",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ad98d66_b6f86951",
        "filename": "customtabs/src/android/support/customtabs/browseractions/BrowserServiceFileProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 216,
      "author": {
        "id": 1233200
      },
      "writtenOn": "2018-01-19T23:48:34Z",
      "side": 1,
      "message": "Ha, I see you point. And I just realize it might be better put this in the same block which remove uri from sFileInSerialization? So then after they both remove uri and the same query come again, it will generate a new CountDownLatch and wait for that one.",
      "parentUuid": "60c677cc_55d85d9f",
      "revId": "e0dfc9300a014e6323b3f3637cd19ff57520fa11",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}