{
  "comments": [
    {
      "key": {
        "uuid": "3deb62d2_4adf2bda",
        "filename": "customtabs/src/android/support/customtabs/CustomTabsService.java",
        "patchSetId": 4
      },
      "lineNbr": 114,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "nit: javadoc",
      "range": {
        "startLine": 114,
        "startChar": 28,
        "endLine": 114,
        "endChar": 57
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "036df902_cf34949a",
        "filename": "customtabs/src/android/support/customtabs/CustomTabsService.java",
        "patchSetId": 4
      },
      "lineNbr": 368,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "It\u0027s a bit odd you use a non-existent example when you already have a good example (TWA splash image).",
      "range": {
        "startLine": 367,
        "startChar": 53,
        "endLine": 368,
        "endChar": 11
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf9467c0_904959ac",
        "filename": "customtabs/src/android/support/customtabs/TrustedWebUtils.java",
        "patchSetId": 4
      },
      "lineNbr": 297,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "This probably deserves its own file.",
      "range": {
        "startLine": 297,
        "startChar": 24,
        "endLine": 297,
        "endChar": 49
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d6399eb_2d737a31",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 65,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "nit: closing bracket",
      "range": {
        "startLine": 65,
        "startChar": 47,
        "endLine": 65,
        "endChar": 48
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1f7bc24c_b8eb7d94",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 163,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2019-03-25T08:24:09Z",
      "side": 1,
      "message": "The comment should mention that isTaskRoot() will also be false if the activity was launched without Intent.FLAG_ACTIVITY_NEW_TASK",
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3630958_200ddb33",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 172,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "But if they customize it the splashscreen will appear broken, right?",
      "range": {
        "startLine": 172,
        "startChar": 21,
        "endLine": 172,
        "endChar": 25
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c8822dc3_f7aaf4ce",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 180,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "This needs to match up with what Chrome shows right? I wonder if there\u0027s some way to make sure of that. We could add a method to TrustedWebUtils (which would then I guess need to make it into the support library) which both here and Chrome use.\n\nI wonder if there\u0027s a way to get Chrome to give this - maybe get the app to load a layout out of Chrome\u0027s resources.\n\nIt seems that once TWAs start building with this, we can\u0027t change Chrome\u0027s splash screen code otherwise there\u0027s be a jank in the transition and I really don\u0027t like that.",
      "range": {
        "startLine": 175,
        "startChar": 0,
        "endLine": 180,
        "endChar": 29
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "925dde05_fc7b5570",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 180,
      "author": {
        "id": 1297953
      },
      "writtenOn": "2019-03-21T19:27:40Z",
      "side": 1,
      "message": "\u003e\u003e It seems that once TWAs start building with this, we can\u0027t change Chrome\u0027s splash screen code otherwise there\u0027s be a jank in the transition and I really don\u0027t like that.\n\nNo matter what the final approach will look like, we\u0027ll need to maintain backwards compatibility from there on. We might need to look at our versioning approach more closely to make that easier. I\u0027m thinking we need to\n- Replace metadata TrustedWebActivitySplashScreensType \u003d \"FileProvider\" with TrustedWebActivitySplashScreensVersion \u003d 1. That number would mean all version up to specified one is supported. Or maybe two metadata entries: MinVersion and MaxVersion.\n- Describe somewhere very precisely what each version does. This is especially important for potential other TWA providers.\n- Pass version number into builder.setSplashScreenParams.\n\nWith that, the only question left is how restrictive the current approach is. First of all, with the FileProvider and its absence of size limitations, the clients are always able to provide an arbitrary full-screen image. Centered logo + background color is just an optimization for presumably most common case. We can easily let clients position and scale the logo with transferring ScaleType and Matrix. I think we should do that, but in a separate pair of CLs.\n\n\u003e\u003e  maybe get the app to load a layout out of Chrome\u0027s resources.\n\nI\u0027m not sure how that would work: the clients should be telling Chrome the parameters, not vice versa.\n\n\u003e\u003e We could add a method to TrustedWebUtils (which would then I guess need to make it into the support library) which both here and Chrome use.\n\nThis won\u0027t work, because client apps and Chrome may use different versions of Custom Tabs library.",
      "parentUuid": "c8822dc3_f7aaf4ce",
      "range": {
        "startLine": 175,
        "startChar": 0,
        "endLine": 180,
        "endChar": 29
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "83c7c397_73a65e0e",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 180,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-22T15:53:56Z",
      "side": 1,
      "message": "For the \"load a layout out of Chrome\u0027s resources\", I was imagining something like this (I\u0027m not sure it would work).\n\n    LayoutInflater inflater \u003d LayoutInflater.from(createPackageContext(providerName, 0));\n    ViewGroup view \u003d inflate.inflate(/* no idea what we put here */);\n    ImageView view \u003d view.findViewById(R.id.image_placeholder);\n    view.setImageResource(...);",
      "parentUuid": "925dde05_fc7b5570",
      "range": {
        "startLine": 175,
        "startChar": 0,
        "endLine": 180,
        "endChar": 29
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d3a5f68_2fb83398",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivity.java",
        "patchSetId": 4
      },
      "lineNbr": 275,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2019-03-25T08:24:09Z",
      "side": 1,
      "message": "Should the service be unbound here similar to CustomTabsClient#connectAndInitialize() to allow the OOM killer to kill Chrome if necessary?",
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69398858_0a1562e5",
        "filename": "customtabs/src/android/support/customtabs/trusted/LauncherActivityMetadata.java",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "I feel there\u0027s some inconsistency between XXX_COLOR and XXX_DRAWABLE_ID - either they should both have _ID or neither should. But it may be too late to change.",
      "range": {
        "startLine": 26,
        "startChar": 48,
        "endLine": 26,
        "endChar": 64
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6803355a_5ad6d1a9",
        "filename": "customtabs/src/android/support/customtabs/trusted/SplashImageTransferTask.java",
        "patchSetId": 4
      },
      "lineNbr": 89,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "Won\u0027t this mean that if an app updates the splash screen resources, but the file is still on disk we will keep on using the old one?\n\nI wonder if we could do something clever with some constant like APK compilation time or hash or something.",
      "range": {
        "startLine": 89,
        "startChar": 21,
        "endLine": 89,
        "endChar": 27
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "84664e98_e2d2774f",
        "filename": "customtabs/src/android/support/customtabs/trusted/SplashImageTransferTask.java",
        "patchSetId": 4
      },
      "lineNbr": 91,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "Don\u0027t we need these lines here as well?\n\n    mContext.grantUriPermission(mProviderPackage, uri, FLAG_GRANT_READ_URI_PERMISSION);\n    mSession.receiveFile(uri, CustomTabsService.FILE_PURPOSE_TWA_SPLASH_IMAGE, null);\n    \nThe file may be saved from a previous run but Chrome may not have it in its Cache anymore.",
      "range": {
        "startLine": 91,
        "startChar": 23,
        "endLine": 91,
        "endChar": 51
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23e4802d_a669e683",
        "filename": "customtabs/src/android/support/customtabs/trusted/SplashImageTransferTask.java",
        "patchSetId": 4
      },
      "lineNbr": 96,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "Are we likely to be cancelled between here and line 80?",
      "range": {
        "startLine": 96,
        "startChar": 16,
        "endLine": 96,
        "endChar": 47
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7845adf1_dd64c94e",
        "filename": "customtabs/src/android/support/customtabs/trusted/StatusAndNavBarUtils.java",
        "patchSetId": 4
      },
      "lineNbr": 38,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2019-03-25T08:24:09Z",
      "side": 1,
      "message": "How would a developer determine what colour to use? Will they need to generate a (\"browser package\", \"browser version\" -\u003e \"color\") map?\nIn order to make it easier switch the colors used in Chrome, I think that we should pass all of the colors from the TWA to Chrome\n\nFor WebAPKs, we will need to pass \"screen orientation lock\" as well",
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c69589ae_e7c4005b",
        "filename": "customtabs/src/android/support/customtabs/trusted/StatusAndNavBarUtils.java",
        "patchSetId": 4
      },
      "lineNbr": 44,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2019-03-21T18:32:03Z",
      "side": 1,
      "message": "Could you give a link to the Chrome code for this (point it to the file at a specific commit, not HEAD or master).",
      "range": {
        "startLine": 44,
        "startChar": 46,
        "endLine": 44,
        "endChar": 52
      },
      "revId": "9237c59954a086d8658fd118e49ee628a3e2c830",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}